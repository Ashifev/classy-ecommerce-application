<!-- Header Section Begin -->
<%- include('../partials/userHeader') %>
<!-- Header Section End -->

<!-- Datatable Stylesheet -->
<link
rel="stylesheet"
href="https://cdn.datatables.net/1.11.5/css/dataTables.bootstrap4.min.css"
/>

    <style>
        .list-group-item.active {
          background: #ffc107;
        }
        /* end common class */
        .top-status ul {
          list-style: none;
          display: flex;
          justify-content: space-around;
          justify-content: center;
          flex-wrap: wrap;
          padding: 0;
          margin: 0;
        }
        .top-status ul li {
          width: 120px;
          height: 120px;
          border-radius: 50%;
          background: #fff;
          display: flex;
          justify-content: center;
          flex-direction: column;
          align-items: center;
          border: 8px solid #ddd;
          box-shadow: 1px 1px 10px 1px #ddd inset;
          margin: 10px 5px;
        }
        .top-status ul li.active {
          border-color: #06c167;
          box-shadow: 1px 1px 20px 1px #ffc107 inset;
        }
        /* end top status */
        
        ul.timeline {
          list-style-type: none;
          position: relative;
        }
        ul.timeline:before {
          content: " ";
          background: #d4d9df;
          display: inline-block;
          position: absolute;
          left: 29px;
          width: 2px;
          height: 100%;
          z-index: 400;
        }
        ul.timeline > li {
          margin: 20px 0;
          padding-left: 30px;
        }
        ul.timeline > li:before {
          content: "\2713";
          background: #fff;
          display: inline-block;
          position: absolute;
          border-radius: 50%;
          border: 0;
          left: 5px;
          width: 50px;
          height: 50px;
          z-index: 400;
          text-align: center;
          line-height: 50px;
          color: #d4d9df;
          font-size: 24px;
          border: 2px solid var(--ogenix-primary);
        }
        ul.timeline > li.active:before {
          content: "\2713";
          background: #28a745;
          display: inline-block;
          position: absolute;
          border-radius: 50%;
          border: 0;
          left: 5px;
          width: 50px;
          height: 50px;
          z-index: 400;
          text-align: center;
          line-height: 50px;
          color: #fff;
          font-size: 30px;
          border: 2px solid var(--ogenix-primary);
        }
        /* end timeline */
        
            
            .list-group-item.active {
              background: #06C167 !important;
            }
        
            .bg-warning {
              background: #06C167 !important;
            }
        
            .modal-content {
              background-color: #fefefe;
              margin: 4% auto;
              padding: 20px;
              border: 1px solid #888;
              width: 70%;
              box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
              transition: transform 0.3s ease-in-out;
              /*transform: translateY(-100%);*/
            }
        
            .close {
              float: right;
              text-align: right;
              font-size: 30px;
            }
        
            .modal-content h2 {
              text-align: center;
              margin-top: -35px;
            }
        
            .button_div {
              justify-content: center;
              text-align: center;
            }
        
            .button_div button {
              margin-right: 10px;
              background: #06C167;
              border: 1px solid #06C167;
              padding: 5px 15px;
              color: #FFFFFF;
              border-radius: 2px;
            }
        
            #addAddressForm input {
              padding: 5px;
            }
        
            .nice-select {
              padding: 0px !important;
              height: 38px !important;
              line-height: 38px !important;
            }
        
            .add_address_button {
              background: #06C167;
              border: 1px solid #06C167;
              padding: 5px 15px;
              color: #FFFFFF;
              border-radius: 2px;
            }
            .add_profile_button {
              background: #06C167;
              border: 1px solid #06C167;
              padding: 5px 15px;
              color: #FFFFFF;
              border-radius: 2px;
            }
        
            @media (max-width: 768px) {
              .main_flex_div {
                display: flex;
                flex-direction: column;
              }
        
              .inner_flex_div {
                min-width: 100% !important;
              }
        
              .modal-content {
                padding: 10px 0px !important;
                min-width: 95% !important;
                height: 700px;
                overflow: scroll;
              }
        
              .close {
                margin-right: 10px;
              }
            }
            .status-pending {
  color: black;
}

.status-delivered {
  color: green;
}

.status-processing {
  color: #ffb700;
}

.status-shipped {
  color: blue;
}
.but-con{
  padding: 5px 10px;
  background-color: blue;
  color: #fff;
  border: none;
  cursor: pointer;
}
          </style>
  <section class="my-5">
    <div class="container">
      <div class="main-body">
        
        <div class="row">
          <div class="col-lg-4">
            <div class="card">
              <div class="card-body">
                <div class="d-flex flex-column align-items-center text-center">
                  <img src="/images/user_profile.jpeg" alt="Admin" class="rounded-circle p-1 bg-warning" width="110">
                  <div class="mt-3">
                    <h4><%= profile.name %></h4>
                    <p class="text-secondary mb-1">+91 7493658737</p>
                    <p class="text-muted font-size-sm">Delhi, NCR</p>
                  </div>
                </div>
                <div class="list-group list-group-flush text-center mt-4">
                  <a href="/profile" class="list-group-item list-group-item-action border-0 " >
                    Profile Informaton
                  </a>
                  <a href="/profile" class="list-group-item list-group-item-action border-0">Orders</a>

                  <a href="/profile" class="list-group-item list-group-item-action border-0 " >
                    Address Book
                  </a>
                  <a href="" class="list-group-item list-group-item-action border-0 active" >
                    Wallet
                </a>
                  <a href="/logout" class="list-group-item list-group-item-action border-0">Logout</a>
                </div>
              </div>
            </div>
          </div>
          <div class="col-lg-8">

<div id="wallet-section" class="main-content p-4" style="display:block;">
    <div class="container">
        <h3 class="mb-4 text-success">WALLET</h3>

        <div class="row">
            <div class="col-md-4 mb-4">
                <div class="card balance-card h-100">
                    <div class="card-body d-flex flex-column justify-content-between">
                        <h5 class="card-title text-muted">Current Balance</h5>
                        <h4 class="balance-amount" >₹<%= wallet?.balance ? wallet?.balance : 0 %></h4>
                        <div>
                            <!-- Additional content can go here -->
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-8 mb-4">
                <div class="card transaction-summary-card h-100">
                    <div class="card-body">
                        <h5 class="card-title text-muted mb-4">Transaction Summary</h5>
                        <div class="row">
                            <div class="col-6 col-md-3 mb-3">
                                <div class="summary-item">
                                    <h6 class="text-muted">This Month</h6>
                                    <h4 class="text-success"> ₹<%= summary?.thisMonth?.totalIn ? summary?.thisMonth?.totalIn : 0 %> </h4>
                                </div>
                            </div>
                            <div class="col-6 col-md-3 mb-3">
                                <div class="summary-item">
                                    <h6 class="text-muted">Last Month</h6>
                                    <h4 class="text-info">₹<%= summary?.lastMonth?.totalIn ? summary?.lastMonth?.totalIn : 0 %></h4>
                                </div>
                            </div>
                            <div class="col-6 col-md-3 mb-3">
                                <div class="summary-item">
                                    <h6 class="text-muted">Total In</h6>
                                    <h4 class="text-success">₹<%= summary?.totalIn ? summary?.totalIn : 0 %></h4>
                                </div>
                            </div>
                            <div class="col-6 col-md-3 mb-3">
                                <div class="summary-item">
                                    <h6 class="text-muted">Total Out</h6>
                                    <h4 class="text-danger">₹<%= summary?.totalOut ? summary?.totalOut : 0 %></h4>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card transaction-log-card mt-4">
            <div class="card-body">
                <h5 class="card-title text-muted mb-4">Recent Transactions</h5>
                <% if(wallet && wallet.transactions.length > 0) { %>
                    <div id="transaction-list" class="transaction-list">
                        <% wallet.transactions.forEach(function(transaction, index) { %>
                            <div class="transaction-item <%= index % 2 === 0 ? 'bg-light' : '' %>">
                                <div class="row align-items-center">
                                    <div class="col-md-1 col-2">
                                        <div class="transaction-icon <%= transaction.type === 'credit' ? 'bg-success' : 'bg-danger' %>">
                                            <i class="fas <%= transaction.type === 'credit' ? 'fa-arrow-down' : 'fa-arrow-up' %>"></i>
                                        </div>
                                    </div>
                                    <div class="col-md-7 col-6">
                                        <h6 class="mb-0"><%= transaction.description %></h6>
                                        <small class="text-muted">
                                            <%= new Date(transaction.createdAt).toLocaleString('en-US', { timeZone: 'Asia/Kolkata' }) %>
                                        </small>
                                    </div>
                                    <div class="col-md-2 col-4 text-right">
                                        <span class="transaction-amount <%= transaction.type === 'credit' ? 'text-success' : 'text-danger' %>">
                                            <%= transaction.type === 'credit' ? '+' : '-' %>₹<%= transaction.amount.toFixed(2) %>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        <% }); %>
                    </div>
                    <!-- Pagination -->
                    <nav aria-label="Transaction log pagination" class="mt-4">
                        <ul id="pagination" class="pagination justify-content-center">
                            <!-- Pagination will be dynamically populated here -->
                        </ul>
                    </nav>
                <% } else { %>
                    <p class="text-center text-muted">No transactions yet.</p>
                <% } %>
            </div>
        </div>
    </div>
</div>


</div>
</div>
</div>
</div>
</section>

 <!-- DataTables JS CDN -->
 <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
 <script src="https://cdn.datatables.net/1.11.5/js/dataTables.bootstrap4.min.js"></script>


 <script>

    $(document).ready(function() {
        // ... (previous code remains the same)
    
        // Pagination logic
        const itemsPerPage = 5;
        const $transactionItems = $('.transaction-item');
        const totalPages = Math.ceil($transactionItems.length / itemsPerPage);
    
        function showPage(page) {
            const start = (page - 1) * itemsPerPage;
            const end = start + itemsPerPage;
    
            $transactionItems.hide();
            $transactionItems.slice(start, end).show();
        }
    
        function setupPagination() {
            const $pagination = $('#pagination');
            $pagination.empty();
    
            // Add "Previous" button
            $pagination.append(`
                <li class="page-item" id="prev-page">
                    <a class="page-link" href="#" aria-label="Previous">
                        <span aria-hidden="true">&laquo;</span>
                    </a>
                </li>
            `);
    
            for (let i = 1; i <= totalPages; i++) {
                const $li = $('<li>').addClass('page-item');
                const $a = $('<a>').addClass('page-link').text(i).attr('href', '#');
    
                $li.append($a);
                $pagination.append($li);
            }
    
            // Add "Next" button
            $pagination.append(`
                <li class="page-item" id="next-page">
                    <a class="page-link" href="#" aria-label="Next">
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
            `);
    
            // Add click event listeners to all pagination items
            $('.page-item').on('click', function(e) {
                e.preventDefault();
                const $this = $(this);
                if ($this.hasClass('disabled')) return;
    
                let targetPage;
                if ($this.attr('id') === 'prev-page') {
                    targetPage = parseInt($('.page-item.active').text()) - 1;
                } else if ($this.attr('id') === 'next-page') {
                    targetPage = parseInt($('.page-item.active').text()) + 1;
                } else {
                    targetPage = parseInt($this.text());
                }
    
                showPage(targetPage);
                updateActivePage(targetPage);
            });
        }
    
        function updateActivePage(page) {
            $('.page-item').removeClass('active disabled');
            $(`.page-item:not(:first-child):not(:last-child):nth-child(${page + 1})`).addClass('active');
            $('#prev-page').toggleClass('disabled', page === 1);
            $('#next-page').toggleClass('disabled', page === totalPages);
        }
    
        // Initial setup
        if (totalPages > 0) {
            showPage(1);
            setupPagination();
            updateActivePage(1);
        }
    });
    
    </script>
    
    <style>
    .page-container {
        display: flex;
        min-height: 100vh;
    }
    
    .main-content {
        flex: 1;
    }
    
    .balance-card {
        background: linear-gradient(135deg, #f9f9f9 40%, #41a828 100%);
        color: white;
    }
    
    .balance-card .card-title {
        color: rgba(255, 255, 255, 0.8);
    }
    
    .balance-amount {
        font-size: 2.5rem;
        font-weight: bold;
    }
    
    .transaction-summary-card,
    .transaction-log-card {
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    
    .summary-item {
        text-align: center;
    }
    
    .transaction-item {
        padding: 1rem 0;
        border-bottom: 1px solid #e0e0e0;
    }
    
    .transaction-item:last-child {
        border-bottom: none;
    }
    
    .transaction-icon {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
    }
    
    .transaction-amount {
        font-weight: bold;
    }
    
    .pagination {
        margin-top: 2rem;
    }
    
    @media (max-width: 767px) {
        .transaction-item .col-md-2.text-right {
            text-align: left !important;
            margin-top: 0.5rem;
        }
    }
    </style>

   <!-- Footer Section Begin -->
   <%- include('../partials/userFooter') %>
   <!-- Footer Section End -->